(function(g,e){typeof exports=="object"&&typeof module<"u"?e(exports,require("react/jsx-runtime"),require("@dnd-kit/core"),require("@dnd-kit/sortable"),require("@dnd-kit/utilities"),require("primereact/button"),require("primereact/buttongroup"),require("primereact/confirmdialog"),require("react"),require("nanoid"),require("primereact/accordion"),require("primereact/inputtext"),require("primereact/calendar"),require("primereact/dropdown"),require("primereact/editor"),require("primereact/tabview"),require("primereact/resources/themes/lara-light-cyan/theme.css"),require("primereact/resources/primereact.min.css"),require("primeicons/primeicons.css"),require("primeflex/primeflex.css")):typeof define=="function"&&define.amd?define(["exports","react/jsx-runtime","@dnd-kit/core","@dnd-kit/sortable","@dnd-kit/utilities","primereact/button","primereact/buttongroup","primereact/confirmdialog","react","nanoid","primereact/accordion","primereact/inputtext","primereact/calendar","primereact/dropdown","primereact/editor","primereact/tabview","primereact/resources/themes/lara-light-cyan/theme.css","primereact/resources/primereact.min.css","primeicons/primeicons.css","primeflex/primeflex.css"],e):(g=typeof globalThis<"u"?globalThis:g||self,e(g["Library name"]={},g.jsxRuntime,g.core,g.sortable,g.utilities,g.button,g.buttongroup,g.confirmdialog,g.React,g.nanoid,g.accordion,g.inputtext,g.calendar,g.dropdown,g.editor,g.tabview))})(this,function(g,e,S,_,Z,E,le,ae,s,z,b,v,ne,re,te,Y){"use strict";class oe{constructor(n){this.label=n}}class V extends oe{constructor(n){super(n.label)}}class se{constructor(n,a){this.render=n,this.validation=a}}class F extends se{constructor(n){super(n.render,n.validation)}}class de{constructor(n,a,r,t,d,o,c,i,h){this.form=n,this.settings=a,this.type=r,this.heading=t,this.description=d,this.hidden=o,this.icon=c,this.default_config=i,this.group=h,this.group||(this.group=new V({label:"None"}))}}class k extends de{constructor(n){super(n.form,n.settings,n.type,n.heading,n.description,n.hidden,n.icon,n.default_config,n.group)}}class J{constructor(n=[]){this.items=n}registerItem(n,a){a&&(n.group=a),this.items.push(n)}addRegistry(n){for(const a of n)this.items.push(a)}getByItem(n){if(n)return this.items.find(a=>a.type===n.type)}*[Symbol.iterator](){for(const n of this.items)yield n}map(n){return this.items.map((a,r,t)=>n(a,r,t))}}const W={id:null,label:null,created_at:null,config:[]},ce=(l=W)=>{const[n,a]=s.useState({...W,...l});return{form:n,setForm:r=>{console.log("formState","setFormHandler",r??W),a({...W,...r})}}},M={id:z.nanoid(),type:"input-text",label:"",value:"",placeholder:""},ie=({config:l,onChange:n})=>{const[a,r]=s.useState({...M,...l});s.useEffect(()=>{r({...M,...l})},[l]);const t=o=>{const c={...M,...l,value:o.target.value};n(c),r(c)},d=Math.random().toString(36).substring(2,15);return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-column gap-2",children:[e.jsx("label",{htmlFor:d,children:a.label}),e.jsx(v.InputText,{value:a.value,onChange:t,placeholder:a.placeholder,className:"w-full",id:d})]})})},he=({config:l,onChange:n})=>{const[a,r]=s.useState({...M,...l}),t=d=>{const o={...a,[d.target.name]:d.target.value};r(o),n(o)};return s.useEffect(()=>{r({...M,...l})},[l]),e.jsx(e.Fragment,{children:e.jsxs(b.Accordion,{activeIndex:0,children:[" ",e.jsx(b.AccordionTab,{header:"General",children:e.jsxs("div",{className:"form-item flex flex-column gap-4",children:[e.jsxs("div",{className:"flex flex-column gap-2",children:[e.jsx("label",{htmlFor:"label",children:"Label"}),e.jsx(v.InputText,{id:"label",value:a.label||"",name:"label",onChange:t,className:"w-full"})]}),e.jsxs("div",{className:"flex flex-column gap-2",children:[e.jsx("label",{htmlFor:"placeholder",children:"Placeholder"}),e.jsx(v.InputText,{id:"placeholder",value:a.placeholder||"",name:"placeholder",onChange:t,className:"w-full"})]})]})},"general")," "]})})},ge=new k({type:M.type,form:new F({render:ie,validation:l=>(console.log(l),{})}),settings:new F({render:he,validation:l=>(console.log(l),{})}),heading:"Text input",description:"a simple box to insert a value into",hidden:!1,icon:()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",children:e.jsx("path",{d:"M254 52.8C249.3 40.3 237.3 32 224 32s-25.3 8.3-30 20.8L57.8 416 32 416c-17.7 0-32 14.3-32 32s14.3 32 32 32l96 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-1.8 0 18-48 159.6 0 18 48-1.8 0c-17.7 0-32 14.3-32 32s14.3 32 32 32l96 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-25.8 0L254 52.8zM279.8 304l-111.6 0L224 155.1 279.8 304z"})}),default_config:M}),q={id:z.nanoid(),type:"input-date",label:"",value:"",placeholder:"",format:"yy-mm-dd"},pe=({config:l,onChange:n})=>{const[a,r]=s.useState({...q,...l});return s.useEffect(()=>{r({...q,...l})},[l]),Math.random().toString(36).substring(2,15),e.jsx(e.Fragment,{children:e.jsx(ne.Calendar,{onChange:t=>{console.log(t.value)},dateFormat:"yy-mm-dd"})})},fe=({config:l,onChange:n})=>{const[a,r]=s.useState({...q,...l}),t=d=>{const o={...a,[d.target.name]:d.target.value};r(o),n(o)};return s.useEffect(()=>{r({...q,...l})},[l]),e.jsx(e.Fragment,{children:e.jsxs(b.Accordion,{activeIndex:0,children:[" ",e.jsx(b.AccordionTab,{header:"General",children:e.jsxs("div",{className:"form-item flex flex-column gap-4",children:[e.jsxs("div",{className:"flex flex-column gap-2",children:[e.jsx("label",{htmlFor:"label",children:"Label"}),e.jsx(v.InputText,{id:"label",value:a.label||"",name:"label",onChange:t,className:"w-full"})]}),e.jsxs("div",{className:"flex flex-column gap-2",children:[e.jsx("label",{htmlFor:"placeholder",children:"Placeholder"}),e.jsx(v.InputText,{id:"placeholder",value:a.placeholder||"",name:"placeholder",onChange:t,className:"w-full"})]}),e.jsxs("div",{className:"flex flex-column gap-2",children:[e.jsx("label",{htmlFor:"format",children:"Format"}),e.jsx(v.InputText,{id:"format",value:a.format||"",name:"format",onChange:t,className:"w-full"}),e.jsxs("ul",{children:[e.jsx("li",{children:"d - day of month (no leading zero)"}),e.jsx("li",{children:"dd - day of month (two digit)"}),e.jsx("li",{children:"o - day of the year (no leading zeros)"}),e.jsx("li",{children:"oo - day of the year (three digit)"}),e.jsx("li",{children:"D - day name short"}),e.jsx("li",{children:"DD - day name long"}),e.jsx("li",{children:"m - month of year (no leading zero)"}),e.jsx("li",{children:"mm - month of year (two digit)"}),e.jsx("li",{children:"M - month name short"}),e.jsx("li",{children:"MM - month name long"}),e.jsx("li",{children:"y - year (two digit)"}),e.jsx("li",{children:"yy - year (four digit)"})]})]})]})},"general")," "]})})},me=new k({type:q.type,form:new F({render:pe,validation:l=>(console.log(l),{})}),settings:new F({render:fe,validation:l=>(console.log(l),{})}),heading:"Date picker input",description:"a simple box to select a date",hidden:!1,icon:()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",children:e.jsx("path",{d:"M152 24c0-13.3-10.7-24-24-24s-24 10.7-24 24l0 40L64 64C28.7 64 0 92.7 0 128l0 16 0 48L0 448c0 35.3 28.7 64 64 64l320 0c35.3 0 64-28.7 64-64l0-256 0-48 0-16c0-35.3-28.7-64-64-64l-40 0 0-40c0-13.3-10.7-24-24-24s-24 10.7-24 24l0 40L152 64l0-40zM48 192l80 0 0 56-80 0 0-56zm0 104l80 0 0 64-80 0 0-64zm128 0l96 0 0 64-96 0 0-64zm144 0l80 0 0 64-80 0 0-64zm80-48l-80 0 0-56 80 0 0 56zm0 160l0 40c0 8.8-7.2 16-16 16l-64 0 0-56 80 0zm-128 0l0 56-96 0 0-56 96 0zm-144 0l0 56-64 0c-8.8 0-16-7.2-16-16l0-40 80 0zM272 248l-96 0 0-56 96 0 0 56z"})}),default_config:q}),A={id:z.nanoid(),type:"input-number",label:"",value:"",placeholder:""},ve=({config:l,onChange:n})=>{const[a,r]=s.useState({...A,...l});s.useEffect(()=>{r({...A,...l})},[l]);const t=o=>{const c={...A,...l,value:o.target.value};n(c)},d=Math.random().toString(36).substring(2,15);return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-column gap-2",children:[e.jsx("label",{htmlFor:d,children:a.label}),e.jsx(v.InputText,{type:"number",value:a.value,onChange:t,placeholder:a.placeholder||"",className:"w-full",id:d})]})})},ue=({config:l,onChange:n})=>{const[a,r]=s.useState({...A,...l}),t=d=>{const o={...a,[d.target.name]:d.target.value};r(o),n(o)};return s.useEffect(()=>{r({...A,...l})},[l]),e.jsx(e.Fragment,{children:e.jsxs(b.Accordion,{activeIndex:0,children:[" ",e.jsx(b.AccordionTab,{header:"General",children:e.jsxs("div",{className:"form-item flex flex-column gap-4",children:[e.jsxs("div",{className:"flex flex-column gap-2",children:[e.jsx("label",{htmlFor:"label",children:"Label"}),e.jsx(v.InputText,{id:"label",value:a.label||"",name:"label",onChange:t,className:"w-full"})]}),e.jsxs("div",{className:"flex flex-column gap-2",children:[e.jsx("label",{htmlFor:"placeholder",children:"Placeholder"}),e.jsx(v.InputText,{id:"placeholder",value:a.placeholder||"",name:"placeholder",onChange:t,className:"w-full"})]})]})},"general")," "]})})},be=new k({type:A.type,form:new F({render:ve,validation:l=>(console.log(l),{})}),settings:new F({render:ue,validation:l=>(console.log(l),{})}),heading:"Number input",description:"a simple box to insert a number value into",hidden:!1,icon:()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 320 512",children:e.jsx("path",{d:"M0 64C0 46.3 14.3 32 32 32l256 0c11.5 0 22 6.1 27.7 16.1s5.7 22.2-.1 32.1l-224 384c-8.9 15.3-28.5 20.4-43.8 11.5s-20.4-28.5-11.5-43.8L232.3 96 32 96C14.3 96 0 81.7 0 64z"})}),default_config:A}),U=new V({label:"Inputs"}),K=new J;K.registerItem(ge,U),K.registerItem(be,U),K.registerItem(me,U);function G(l){return JSON.parse(JSON.stringify(l))}const L={id:z.nanoid(),type:"select-select",label:"",value:"",options:[],placeholder:""},xe=({config:l,onChange:n})=>{const[a,r]=s.useState({...L,...l});s.useEffect(()=>{r({...L,...l})},[l]);const t=o=>{const c={...L,...l,value:o.target.value};n(c)},d=Math.random().toString(36).substring(2,15);return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-column gap-2",children:[e.jsx("label",{htmlFor:d,children:a.label}),e.jsx(re.Dropdown,{id:d,value:a.value||"",onChange:t,options:a.options,showClear:!0,placeholder:a.placeholder||"",className:"w-full",children:" "})]})})},we=({option:l,onChange:n})=>{const[a,r]=s.useState(l),t=d=>{const o={value:a.value,label:a.label,[d.target.name]:d.target.value};r(o),n(o)};return s.useEffect(()=>{r(l)},[l]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx(E.Button,{icon:"pi pi-sort",className:"px-0 border-noround border-0",style:{width:"1rem",color:"#E1E1E1",background:"transparent"},severity:"secondary",size:"small"}),e.jsxs("div",{className:"p-inputgroup flex-1",children:[e.jsx(v.InputText,{id:"value",value:a.value,name:"value",onChange:t,className:"flex-1",placeholder:"Value"})," ",e.jsx(v.InputText,{id:"label",value:a.label,name:"label",onChange:t,className:"flex-1",placeholder:"Label"})]}),e.jsx(E.Button,{icon:"pi pi-trash",onClick:()=>n(null)})]})})},Ie=({onInsert:l})=>{const n={value:"",label:""},[a,r]=s.useState(n),t=o=>{const c={value:a.value,label:a.label,[o.target.name]:o.target.value};r(c)},d=()=>{l({value:a.value,label:a.label}),r(n)};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsxs("div",{className:"p-inputgroup flex-1",children:[e.jsx(v.InputText,{id:"value",value:a.value,name:"value",onChange:t,className:"",placeholder:"Value"})," ",e.jsx(v.InputText,{id:"label",value:a.label,name:"label",onChange:t,className:"",placeholder:"Label"})]}),e.jsx(E.Button,{icon:"pi pi-plus",onClick:d})]})})},ye=({config:l,onChange:n})=>{const[a,r]=s.useState({...L,...l}),t=c=>{const i={...a,[c.target.name]:c.target.value};r(i),n(i)},d=(c,i)=>{const h=G(a.options);c?h[i]=c:h.splice(i,1),console.log(i,h);const I={...a,options:h};r(I),n(I)};s.useEffect(()=>{r({...L,...l})},[l]);const o=c=>{const i=G(a.options);i.push(c);const h={...a,options:i};r(h),n(h)};return e.jsx(e.Fragment,{children:e.jsxs(b.Accordion,{activeIndex:0,children:[e.jsx(b.AccordionTab,{header:"General",children:e.jsxs("div",{className:"form-item flex flex-column gap-4",children:[e.jsxs("div",{className:"flex flex-column gap-2",children:[e.jsx("label",{htmlFor:"label",children:"Label"}),e.jsx(v.InputText,{id:"label",value:a.label||"",name:"label",onChange:t,className:"w-full"})]}),e.jsxs("div",{className:"flex flex-column gap-2",children:[e.jsx("label",{htmlFor:"placeholder",children:"Placeholder"}),e.jsx(v.InputText,{id:"placeholder",value:a.placeholder||"",name:"placeholder",onChange:t,className:"w-full"})]})]})},"general")," ",e.jsx(b.AccordionTab,{header:"Options",children:e.jsxs("div",{className:"form-item flex flex-column gap-4",children:[a.options.map((c,i)=>e.jsx(we,{option:c,onChange:h=>{d(h,i)}},`option-${i}`))," ",e.jsx(Ie,{onInsert:o},"item-new")]})},"options")]})})},Ce=new k({type:L.type,form:new F({render:xe,validation:l=>(console.log(l),{})}),settings:new F({render:ye,validation:l=>(console.log(l),{})}),heading:"Select box",description:"select from a list of items in a drop down",hidden:!1,icon:()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",children:e.jsx("path",{d:"M384 432c8.8 0 16-7.2 16-16l0-320c0-8.8-7.2-16-16-16L64 80c-8.8 0-16 7.2-16 16l0 320c0 8.8 7.2 16 16 16l320 0zm64-16c0 35.3-28.7 64-64 64L64 480c-35.3 0-64-28.7-64-64L0 96C0 60.7 28.7 32 64 32l320 0c35.3 0 64 28.7 64 64l0 320zM224 352c-6.7 0-13-2.8-17.6-7.7l-104-112c-6.5-7-8.2-17.2-4.4-25.9s12.5-14.4 22-14.4l208 0c9.5 0 18.2 5.7 22 14.4s2.1 18.9-4.4 25.9l-104 112c-4.5 4.9-10.9 7.7-17.6 7.7z"})}),default_config:L}),Ne=new V({label:"Selects"}),j=new J;j.registerItem(Ce,Ne);const $={id:z.nanoid(),type:"content-html",label:"",value:"",placeholder:""},Se=({config:l,onChange:n})=>{const[a,r]=s.useState({...$,...l});s.useEffect(()=>{r({...$,...l})},[l]);const t=Math.random().toString(36).substring(2,15);return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-column gap-2",children:[e.jsx("label",{htmlFor:t,children:a.label}),e.jsx("div",{dangerouslySetInnerHTML:{__html:a.value}})]})})},Fe=({config:l,onChange:n})=>{const[a,r]=s.useState({...$,...l}),t=o=>{const c={...a,[o.target.name]:o.target.value};r(c),n(c)},d=o=>{const c={...a,value:o};r(c),n(c)};return s.useEffect(()=>{r({...$,...l})},[l]),e.jsx(e.Fragment,{children:e.jsx(b.Accordion,{activeIndex:0,children:e.jsx(b.AccordionTab,{header:"General",children:e.jsxs("div",{className:"form-item flex flex-column gap-4",children:[e.jsxs("div",{className:"flex flex-column gap-2",children:[e.jsx("label",{htmlFor:"label",children:"Label"}),e.jsx(v.InputText,{id:"label",value:a.label||"",name:"label",onChange:t,className:"w-full"})]}),e.jsx(te.Editor,{value:a.value,name:"value",onTextChange:o=>d(o.htmlValue??""),style:{minHeight:"300px"}})]})},"general")})})},De=new k({type:$.type,form:new F({render:Se,validation:l=>(console.log(l),{})}),settings:new F({render:Fe,validation:l=>(console.log(l),{})}),heading:"HTML Content",description:"WYSIWYG editor for adding in content to the form",hidden:!1,icon:()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 640 512",children:e.jsx("path",{d:"M392.8 1.2c-17-4.9-34.7 5-39.6 22l-128 448c-4.9 17 5 34.7 22 39.6s34.7-5 39.6-22l128-448c4.9-17-5-34.7-22-39.6zm80.6 120.1c-12.5 12.5-12.5 32.8 0 45.3L562.7 256l-89.4 89.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l112-112c12.5-12.5 12.5-32.8 0-45.3l-112-112c-12.5-12.5-32.8-12.5-45.3 0zm-306.7 0c-12.5-12.5-32.8-12.5-45.3 0l-112 112c-12.5 12.5-12.5 32.8 0 45.3l112 112c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L77.3 256l89.4-89.4c12.5-12.5 12.5-32.8 0-45.3z"})}),default_config:$}),Te=new V({label:"Content"}),R=new J;R.registerItem(De,Te);const B=new J;B.addRegistry(K),B.addRegistry(j),B.addRegistry(R);const Q=({item:l,onChange:n})=>{const a=B.getByItem(l);return l&&a?s.createElement(a.form.render,{config:l,onChange:n}):s.createElement(()=>e.jsxs("div",{children:["The component ",l.type," was not found."]}))};function Ee({id:l,config:n,active:a,setActive:r,onItemChange:t,onItemRemove:d}){const{attributes:o,listeners:c,setNodeRef:i,setActivatorNodeRef:h,transform:I,transition:p}=_.useSortable({id:l,data:{id:l,item:n}}),x={transform:Z.CSS.Transform.toString(I),transition:p};let m="sortable-item";n.id==(a==null?void 0:a.id)&&(m=m+" active");const D=()=>{ae.confirmDialog({message:"Are you sure you want to remove this item?",header:"Confirmation",icon:"pi pi-exclamation-triangle",accept:()=>d(l)})};let C=e.jsx(E.Button,{size:"small",outlined:!0,label:"Edit",icon:"pi pi-pencil",onClick:()=>r(n)});return a&&a.id==n.id&&(C=e.jsx(E.Button,{size:"small",outlined:!0,label:"Done",icon:"pi pi-pencil",onClick:()=>r(void 0)})),e.jsx(e.Fragment,{children:e.jsxs("div",{ref:i,style:x,...o,className:m,children:[e.jsx(Q,{item:n,onChange:t}),e.jsxs("div",{className:"flex flex-row align-items-center item-footer",children:[e.jsxs("div",{className:"flex-grow-1 item-type",children:[" ",n.type]}),e.jsxs(le.ButtonGroup,{children:[" ",e.jsx(E.Button,{...c,ref:h,size:"small",outlined:!0,label:"Order",icon:"pi pi-sort"}),C,e.jsx(E.Button,{size:"small",outlined:!0,label:"Remove",icon:"pi pi-trash",onClick:D})]})]})]})})}function Oe({form:l,onFormChange:n,activeItem:a,setActiveItem:r}){console.log("reloading CanvasComponent");const[t,d]=s.useState((l==null?void 0:l.config)??[]);s.useEffect(()=>{l&&l.config&&l.config!=t&&(console.log("resetting items",l,l.config,t),d(l.config??[]))},[l]);const o=m=>{const D=G(l);D.config=D.config.filter(C=>C.id!=m),n(D),a&&a.id==m&&r(void 0)},c=m=>{const D=t.map(T=>T.id==m.id?m:T);d(D);const C=G(l);C.config=D,n(C)},{listeners:i,setNodeRef:h,transform:I,transition:p}=S.useDroppable({id:"canvas_droppable",data:{parent:null,isContainer:!0}}),x={transform:Z.CSS.Transform.toString(I),transition:p};return e.jsx("div",{ref:h,className:"canvas",style:x,...i,children:t==null?void 0:t.map(m=>e.jsx(Ee,{id:m.id,config:m,active:a,setActive:r,onItemChange:c,onItemRemove:o},m.id))})}const _e=({item:l,onChange:n})=>{const a=B.getByItem(l);return a?s.createElement(a.settings.render,{config:l,onChange:n}):s.createElement(()=>e.jsxs("div",{children:["The component ",l.type," was not found."]}))};function ze({form:l,onFormChange:n,activeItem:a,setActiveItem:r}){console.log("reloading PropertiesComponent");const[t,d]=s.useState(l),[o,c]=s.useState(a),i=p=>{console.log("handleFormItemChange",p),c(p);const x=G(t);x.config=x.config.map(m=>m.id==p.id?p:m),n(x)},h=p=>{const x={...t,[p.target.name]:p.target.value};console.log(x),d(x),n(x)},I=()=>{r(void 0)};if(console.log("activeItem",o),s.useEffect(()=>{c(a)},[a]),s.useEffect(()=>{d(l)},[l]),o){const p=B.getByItem(o);if(p){const x=p.icon;return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"properties active",children:[e.jsxs("div",{className:"item-panel-item flex align-items-center",children:[e.jsxs("div",{className:"flex-grow-1 flex align-items-center",children:[e.jsx("div",{className:"item-icon mr-2",children:e.jsx(x,{})}),e.jsx("div",{children:e.jsx("h2",{children:p.heading})})]}),e.jsx(E.Button,{onClick:I,size:"small",outlined:!0,icon:"pi pi-times"})]}),e.jsx(_e,{item:o,onChange:i})]})})}return s.createElement(()=>e.jsxs("div",{children:["The component ",o.type," was not found."]}))}else return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"properties",children:[e.jsx("div",{className:"item-panel-item flex px-3",children:e.jsx("div",{children:e.jsx("h2",{children:"Form Settings"})})}),e.jsx(b.Accordion,{activeIndex:0,children:e.jsx(b.AccordionTab,{header:"General",children:e.jsx("div",{className:"form-item flex flex-column gap-4",children:e.jsxs("div",{className:"flex flex-column gap-2",children:[e.jsx("label",{htmlFor:"label",children:"Form label"}),e.jsx(v.InputText,{onChange:h,name:"label",value:t.label??"",className:"w-full"})]})})},"general")})]})})}function ee({item:l}){const n=l.icon;return e.jsx(e.Fragment,{children:e.jsx("article",{className:"sidebar-field",children:e.jsxs("div",{className:"item-panel-item flex p-2 w-100",children:[e.jsx("div",{className:"item-icon mr-2",children:e.jsx(n,{})}),e.jsxs("div",{children:[e.jsx("div",{className:"item-title",children:l.heading}),e.jsx("div",{className:"item-text",children:l.description})]})]})})})}function Me({item:l}){const n=s.useRef(z.nanoid()),{attributes:a,listeners:r,setNodeRef:t}=S.useDraggable({id:n.current,data:{item:l,fromSidebar:!0}});return e.jsx("div",{ref:t,className:"sidebar-field",...a,...r,children:e.jsx(ee,{item:l})})}function Ae({form:l,onFormChange:n,activeItem:a,setActiveItem:r}){const[t,d]=s.useState(0),o={};B.map(i=>{var I,p;const h=((I=i.group)==null?void 0:I.label)||"";Object.keys(o).includes(h)||(o[h]={label:((p=i.group)==null?void 0:p.label)||"",items:[]}),o[h].items.push(i)});const c=i=>{d(i)};return e.jsx(e.Fragment,{children:e.jsxs(Y.TabView,{activeIndex:t,onTabChange:i=>c(i.index),className:"sidebar",children:[e.jsxs(Y.TabPanel,{header:"Items",children:[" "," "," "," "," "," "," ",e.jsx(b.Accordion,{activeIndex:0,children:Object.keys(o).map(i=>e.jsx(b.AccordionTab,{header:o[i].label,children:o[i].items.map(h=>e.jsx(Me,{item:h},`sidebar-${h.type}`))},i))})]}),e.jsxs(Y.TabPanel,{header:"Forms",children:["forms ",JSON.stringify(l)]})]})})}function P(l){var n;return((n=l==null?void 0:l.data)==null?void 0:n.current)??{}}let X=0;const Le=({config:l,onChange:n})=>{X=X+1,console.log("******************",X,"******************");const{form:a,setForm:r}=ce(l),[t,d]=s.useState(void 0);s.useEffect(()=>{l&&r(l)},[l]),s.useEffect(()=>{a&&n(a)},[a]);const o=S.useSensors(S.useSensor(S.PointerSensor),S.useSensor(S.KeyboardSensor,{coordinateGetter:_.sortableKeyboardCoordinates})),[c,i]=s.useState(),[h,I]=s.useState(),p=()=>{i(void 0),I(void 0)},x=T=>{const{active:H}=T,N=P(H);console.log("handleDragStart",N);const{item:f}=N;if(N.fromSidebar){const w=f.default_config;w.id=z.nanoid(),f.id=w.id,console.log("handleDragStart","sidebar",f,w),console.log(w),i(f),d(N.item)}else I(N.item)},m=T=>{const{active:H,over:N}=T;console.log("over",N);const f=P(H),w=P(N);if(f.fromSidebar)if(console.log("handleDragOver","fromSidebar",f.item.id),a.config.findIndex(u=>u.id===f.item.id)==-1){console.log("handleDragOver","new item",f.item.default_config,w),a.config.push(f.item.default_config);const u=a.config.findIndex(y=>y.id===f.item.id),O=a.config.findIndex(y=>y.id===w.id);a.config=_.arrayMove(a.config,u,O),r(a)}else if(!N)console.log("handleDragOver","!over",w),a.config=a.config.filter(u=>u.id!==f.item.id),r(a);else{console.log("handleDragOver","else",w);const u=a.config.findIndex(y=>y.id===f.item.id),O=a.config.findIndex(y=>y.id===w.id);console.log("arrayMove",a.config,u,O,w,f),a.config=_.arrayMove(a.config,u,O),r(a),console.log("SET FORM NOW ",a.config,a.config.map(y=>y.id))}else a.config.findIndex(u=>u.id===f.item.id),a.config.findIndex(u=>u.id===w.id)},D=T=>{const{active:H,over:N}=T,f=P(H),w=P(N);console.log("handleDragEnd",f,w),console.log("handleDragEnd",a.config);const u=a.config.findIndex(y=>y.id===f.item.id),O=a.config.findIndex(y=>y.id===w.id);u!=O&&(a.config=_.arrayMove(a.config,u,O),console.log("handleDragEnd normal sorting",u,O),r(a)),d(f.item),p()},C={form:a,onFormChange:r,activeItem:t,setActiveItem:d};return console.log(r),a?e.jsx(e.Fragment,{children:e.jsx("div",{className:"form-builder",children:e.jsxs(S.DndContext,{sensors:o,onDragStart:x,onDragOver:m,onDragEnd:D,collisionDetection:S.closestCenter,autoScroll:!0,children:[e.jsx("div",{className:"sidebar-area",children:e.jsx(Ae,{...C})}),e.jsx("div",{className:"canvas-area",children:e.jsx(_.SortableContext,{strategy:_.rectSwappingStrategy,items:a.config.map(T=>T.id),children:e.jsx(Oe,{...C})})}),e.jsx("div",{className:"properties-area",children:e.jsx(ze,{...C})}),e.jsxs(S.DragOverlay,{dropAnimation:null,children:[c?e.jsx(ee,{item:c}):null," ",h?e.jsx(Q,{item:h,onChange:()=>{}}):null]})]})})}):e.jsx(e.Fragment,{children:e.jsx("div",{children:"No form config loaded"})})};g.FormBuilder=Le,g.ItemRender=Q,Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})});
//# sourceMappingURL=index.umd.cjs.map
